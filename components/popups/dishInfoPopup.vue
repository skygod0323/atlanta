<template>
  <div class="popup-bg">
    <div class="popup-wizard">
      <img v-if="meal" class="product-img" :src="domain + meal.image" alt />
      <div class="popup-wizard-content">
        <svg
          width="17"
          height="17"
          viewBox="0 0 17 17"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="close-button"
          @click="close()"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M11.5046 8.50027L16.3769 3.62779C17.2077 2.79694 17.2077 1.45399 16.3769 0.623137C15.5461 -0.207712 14.2031 -0.207712 13.3723 0.623137L8.5 5.49561L3.62768 0.623137C2.79686 -0.207712 1.45394 -0.207712 0.623117 0.623137C-0.207706 1.45399 -0.207706 2.79694 0.623117 3.62779L5.49544 8.50027L0.623117 13.3727C-0.207706 14.2036 -0.207706 15.5465 0.623117 16.3774C1.03747 16.7918 1.58143 17 2.1254 17C2.66936 17 3.21333 16.7918 3.62768 16.3774L8.5 11.5049L13.3723 16.3774C13.7867 16.7918 14.3306 17 14.8746 17C15.4186 17 15.9625 16.7918 16.3769 16.3774C17.2077 15.5465 17.2077 14.2036 16.3769 13.3727L11.5046 8.50027Z"
            fill="white"
          />
        </svg>
        <p v-if="meal" class="meal-name">{{ meal.name }}</p>
        <div class="meal-values">
          <div class="value-pair">
            <svg
              width="12"
              height="14"
              viewBox="0 0 12 14"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M9.38761 13.0226C9.00438 13.3174 8.50324 13.5975 7.92841 13.8038C7.81049 13.848 7.69258 13.7301 7.72206 13.6122C7.81049 13.2437 7.86945 12.8605 7.86945 12.4625C7.86945 10.4137 6.42499 8.6745 5.92385 8.11441C5.82068 8.01123 5.65854 8.01123 5.57011 8.11441C5.06897 8.65976 3.62451 10.399 3.62451 12.4625C3.62451 12.9194 3.69821 13.3764 3.81612 13.7891C3.8456 13.907 3.74243 14.0249 3.62451 13.9954C2.63697 13.7301 1.84105 13.3027 1.54626 13.0668C-0.856261 11.0328 -0.0161164 7.83436 1.10408 6.15407C2.34218 4.25269 3.81612 2.63136 3.74242 0.361494C3.72769 0.0961853 4.02247 -0.0806873 4.2583 0.0372278C6.1302 0.980548 7.41253 3.02932 7.75154 4.66539C8.25267 4.19373 8.45903 3.45676 8.47377 2.80823C8.47377 2.4987 8.87173 2.33657 9.09282 2.5724C10.7731 4.38534 13.3672 9.91261 9.38761 13.0226Z"
                fill="#A4B6C0"
              />
            </svg>
            <p v-if="meal">{{ meal.calories }}g Calories</p>
          </div>
          <div class="value-spacer"></div>
          <div class="value-pair">
            <svg
              width="11"
              height="14"
              viewBox="0 0 11 14"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M0 8.66807C0 5.83383 3.33024 2.16702 5.34964 0C5.57131 0.264132 5.81789 0.550545 6.08002 0.855016C7.96848 3.04852 10.6639 6.17928 10.6639 8.66807C10.6639 10.3332 9.3294 14 5.33193 14C1.33446 14 0 10.3332 0 8.66807ZM1.59364 8.60186C1.542 8.49639 1.49094 8.39208 1.43989 8.2892C0.214175 9.74708 2.65839 13.9336 6.11922 13.2047C3.26094 12.0077 2.36399 10.1755 1.59364 8.60186Z"
                fill="#A4B6C0"
              />
            </svg>
            <p v-if="meal">{{ meal.fat }}g Fat</p>
          </div>
          <div class="value-spacer"></div>
          <div class="value-pair">
            <svg
              width="12"
              height="16"
              viewBox="0 0 12 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M5.98674 7.1517C6.51939 6.52504 7.49071 5.20907 7.49071 3.67376C7.49071 2.13846 6.51939 0.791152 5.98674 0.164497C5.79874 -0.0548323 5.48541 -0.0548323 5.29742 0.164497C4.76476 0.791152 3.79344 2.10713 3.79344 3.64243C3.79344 5.17773 4.76476 6.52504 5.29742 7.12036C5.48541 7.33969 5.79874 7.33969 5.98674 7.1517ZM4.80842 10.7982C5.09702 10.8109 5.31667 10.6131 5.29855 10.33C5.28052 9.50593 5.05931 7.8905 3.99766 6.74142C2.94145 5.6232 1.33154 5.33438 0.491175 5.25984C0.202582 5.2471 -0.0170669 5.44491 0.00104422 5.72806C0.01908 6.5521 0.240292 8.16753 1.30194 9.31661C2.36359 10.4657 3.99892 10.7182 4.80842 10.7982ZM5.95426 10.3613C6.00316 9.5427 6.19895 7.89097 7.25516 6.77275C8.31681 5.62367 9.95758 5.3403 10.7616 5.29118C11.0194 5.27299 11.2699 5.47624 11.2518 5.75939C11.2029 6.57799 11.0071 8.22972 9.95088 9.34794C8.89467 10.4662 7.2539 10.7495 6.4444 10.8295C6.18666 10.8477 5.93615 10.6445 5.95426 10.3613ZM4.80842 15.9994C5.09702 16.0122 5.31667 15.8144 5.29855 15.5312C5.28052 14.7072 5.05931 13.0917 3.99766 11.9427C2.94145 10.8244 1.33154 10.5356 0.491175 10.4611C0.202582 10.4483 -0.0170669 10.6461 0.00104422 10.9293C0.01908 11.7533 0.240292 13.3688 1.30194 14.5178C2.36359 15.6669 3.99892 15.9194 4.80842 15.9994ZM7.2553 11.9113C8.3115 10.7931 9.95228 10.5097 10.7618 10.4298C11.0504 10.417 11.2646 10.6457 11.2519 10.898C11.203 11.7166 11.0072 13.3683 9.95101 14.4865C8.89481 15.6047 7.25404 15.8881 6.44453 15.9681C6.1868 15.9863 5.93629 15.783 5.9544 15.4999C6.00329 14.6813 6.19909 13.0296 7.2553 11.9113Z"
                fill="#A4B6C0"
              />
            </svg>
            <p v-if="meal">{{ meal.carbs }}g Carbs</p>
          </div>
          <div class="value-spacer"></div>
          <div class="value-pair">
            <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M15.6436 3.00637C15.7913 3.05508 15.9079 3.16941 15.9592 3.31578C16.0279 3.47486 16.009 3.65808 15.9091 3.79985C15.6336 4.22403 14.6669 5.63133 13.8154 5.76607C13.712 5.77428 13.6082 5.77428 13.5048 5.76607C13.0553 5.74807 12.6133 5.64475 12.2025 5.46165C12.453 5.99178 12.5435 6.58298 12.463 7.16338C12.3056 7.65603 12.0017 8.08939 11.5915 8.40599C11.2504 8.70936 10.8852 8.98473 10.4995 9.22941H10.4545L10.3994 9.25436H10.2992C10.2075 9.26094 10.1154 9.26094 10.0237 9.25436C9.57613 9.23743 9.13587 9.13581 8.72641 8.95494C8.93277 9.50288 8.98304 10.097 8.87167 10.6716V10.7515C8.71199 11.2416 8.40839 11.6727 8.00013 11.9891C7.66226 12.2854 7.30226 12.5557 6.92324 12.7976C6.88891 12.8203 6.8519 12.8387 6.81304 12.8524H6.72789C6.63617 12.8587 6.54413 12.8587 6.45241 12.8524C5.99946 12.8355 5.55398 12.7321 5.14009 12.548C5.36597 13.0258 5.46595 13.5531 5.4306 14.0801V14.1549C5.27213 14.647 4.96624 15.0789 4.55406 15.3926C4.53296 15.415 4.50945 15.4351 4.48394 15.4524C4.16785 15.7203 3.83309 15.9654 3.48217 16.186L3.43208 16.216H3.387H3.29684C3.20512 16.2223 3.11308 16.2223 3.02136 16.216C2.29991 14.0722 1.90552 13.4963 1.26469 12.5605C0.979337 12.1438 0.64512 11.6558 0.211404 10.9261C0.0178097 10.4191 -0.0442112 9.87152 0.0310857 9.33421C0.0289138 9.32434 0.0289138 9.31413 0.0310857 9.30427C0.0286534 9.29275 0.0286534 9.28085 0.0310857 9.26933C0.201342 8.79563 0.503681 8.38015 0.902622 8.07164C1.22194 7.77976 1.56731 7.51751 1.93444 7.28814C1.95193 7.27006 1.97223 7.2549 1.99455 7.24323H2.03462H2.06467H2.11476C2.13805 7.24041 2.16159 7.24041 2.18488 7.24323H2.21494C2.72586 7.19267 3.24148 7.26631 3.71758 7.45782C3.53999 6.94491 3.49519 6.39563 3.58736 5.86088C3.58506 5.84935 3.58506 5.83748 3.58736 5.82595C3.59374 5.79106 3.60557 5.75738 3.62242 5.72614C3.80312 5.29805 4.08699 4.92096 4.44887 4.62825C4.76252 4.34384 5.0974 4.08359 5.45064 3.84975C5.48695 3.81925 5.52742 3.79404 5.57085 3.77489C5.59573 3.76058 5.62281 3.75046 5.65099 3.74495H5.72112C6.2324 3.69795 6.74756 3.77323 7.22377 3.96453C7.03495 3.47881 6.96125 2.95622 7.00839 2.43747C7.00621 2.40923 7.00621 2.38087 7.00839 2.35263V2.29773C7.17783 1.81952 7.48219 1.40018 7.88493 1.09006C8.19684 0.803602 8.5319 0.543222 8.8867 0.311552L8.93679 0.276619L9.0019 0.241686H9.03195H9.06702H9.13714H9.16218C10.4094 0.0620312 12.1374 1.07009 13.6401 1.96338C14.2766 2.36768 14.947 2.71663 15.6436 3.00637ZM8.71139 6.91885C8.40084 6.39486 8.08028 5.8509 7.79978 5.31194V5.28699C7.35969 5.06076 6.89386 4.88818 6.41234 4.77298C6.72777 5.46551 7.09617 6.13286 7.51428 6.76914C7.65453 6.99371 7.78976 7.21328 7.91999 7.43286C8.3946 7.7235 8.89818 7.96433 9.42264 8.15148L9.36219 8.04532L9.36213 8.04522L9.362 8.04499C9.1665 7.70161 8.94715 7.31637 8.71139 6.91885ZM4.2936 8.80523C4.57409 9.34918 4.89466 9.89313 5.20521 10.4121C5.46567 10.8513 5.70609 11.2705 5.91646 11.6448C5.39187 11.4579 4.88826 11.2171 4.41381 10.9261C4.34178 10.8047 4.26669 10.6833 4.19107 10.561L4.19099 10.5608C4.12992 10.4621 4.06851 10.3627 4.0081 10.2624C3.58958 9.62726 3.22276 8.95974 2.91116 8.26626C3.39211 8.38106 3.8578 8.55191 4.29861 8.77528L4.2936 8.80523ZM11.1784 3.55443C11.254 3.67672 11.3291 3.79817 11.4011 3.91962C12.1525 4.35877 13.0891 4.82787 13.6551 4.73305C14.0929 4.47917 14.4638 4.12507 14.737 3.70004C14.2361 3.46549 13.7352 3.16606 13.1492 2.81175C12.0873 2.18794 10.8251 1.44936 9.9085 1.25973C10.2201 1.95132 10.5834 2.61859 10.9954 3.25589C11.0559 3.35625 11.1173 3.45562 11.1784 3.55443Z" fill="black"/>
            <mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="16" height="17">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M15.6436 3.00637C15.7913 3.05508 15.9079 3.16941 15.9592 3.31578C16.0279 3.47486 16.009 3.65808 15.9091 3.79985C15.6336 4.22403 14.6669 5.63133 13.8154 5.76607C13.712 5.77428 13.6082 5.77428 13.5048 5.76607C13.0553 5.74807 12.6133 5.64475 12.2025 5.46165C12.453 5.99178 12.5435 6.58298 12.463 7.16338C12.3056 7.65603 12.0017 8.08939 11.5915 8.40599C11.2504 8.70936 10.8852 8.98473 10.4995 9.22941H10.4545L10.3994 9.25436H10.2992C10.2075 9.26094 10.1154 9.26094 10.0237 9.25436C9.57613 9.23743 9.13587 9.13581 8.72641 8.95494C8.93277 9.50288 8.98304 10.097 8.87167 10.6716V10.7515C8.71199 11.2416 8.40839 11.6727 8.00013 11.9891C7.66226 12.2854 7.30226 12.5557 6.92324 12.7976C6.88891 12.8203 6.8519 12.8387 6.81304 12.8524H6.72789C6.63617 12.8587 6.54413 12.8587 6.45241 12.8524C5.99946 12.8355 5.55398 12.7321 5.14009 12.548C5.36597 13.0258 5.46595 13.5531 5.4306 14.0801V14.1549C5.27213 14.647 4.96624 15.0789 4.55406 15.3926C4.53296 15.415 4.50945 15.4351 4.48394 15.4524C4.16785 15.7203 3.83309 15.9654 3.48217 16.186L3.43208 16.216H3.387H3.29684C3.20512 16.2223 3.11308 16.2223 3.02136 16.216C2.29991 14.0722 1.90552 13.4963 1.26469 12.5605C0.979337 12.1438 0.64512 11.6558 0.211404 10.9261C0.0178097 10.4191 -0.0442112 9.87152 0.0310857 9.33421C0.0289138 9.32434 0.0289138 9.31413 0.0310857 9.30427C0.0286534 9.29275 0.0286534 9.28085 0.0310857 9.26933C0.201342 8.79563 0.503681 8.38015 0.902622 8.07164C1.22194 7.77976 1.56731 7.51751 1.93444 7.28814C1.95193 7.27006 1.97223 7.2549 1.99455 7.24323H2.03462H2.06467H2.11476C2.13805 7.24041 2.16159 7.24041 2.18488 7.24323H2.21494C2.72586 7.19267 3.24148 7.26631 3.71758 7.45782C3.53999 6.94491 3.49519 6.39563 3.58736 5.86088C3.58506 5.84935 3.58506 5.83748 3.58736 5.82595C3.59374 5.79106 3.60557 5.75738 3.62242 5.72614C3.80312 5.29805 4.08699 4.92096 4.44887 4.62825C4.76252 4.34384 5.0974 4.08359 5.45064 3.84975C5.48695 3.81925 5.52742 3.79404 5.57085 3.77489C5.59573 3.76058 5.62281 3.75046 5.65099 3.74495H5.72112C6.2324 3.69795 6.74756 3.77323 7.22377 3.96453C7.03495 3.47881 6.96125 2.95622 7.00839 2.43747C7.00621 2.40923 7.00621 2.38087 7.00839 2.35263V2.29773C7.17783 1.81952 7.48219 1.40018 7.88493 1.09006C8.19684 0.803602 8.5319 0.543222 8.8867 0.311552L8.93679 0.276619L9.0019 0.241686H9.03195H9.06702H9.13714H9.16218C10.4094 0.0620312 12.1374 1.07009 13.6401 1.96338C14.2766 2.36768 14.947 2.71663 15.6436 3.00637ZM8.71139 6.91885C8.40084 6.39486 8.08028 5.8509 7.79978 5.31194V5.28699C7.35969 5.06076 6.89386 4.88818 6.41234 4.77298C6.72777 5.46551 7.09617 6.13286 7.51428 6.76914C7.65453 6.99371 7.78976 7.21328 7.91999 7.43286C8.3946 7.7235 8.89818 7.96433 9.42264 8.15148L9.36219 8.04532L9.36213 8.04522L9.362 8.04499C9.1665 7.70161 8.94715 7.31637 8.71139 6.91885ZM4.2936 8.80523C4.57409 9.34918 4.89466 9.89313 5.20521 10.4121C5.46567 10.8513 5.70609 11.2705 5.91646 11.6448C5.39187 11.4579 4.88826 11.2171 4.41381 10.9261C4.34178 10.8047 4.26669 10.6833 4.19107 10.561L4.19099 10.5608C4.12992 10.4621 4.06851 10.3627 4.0081 10.2624C3.58958 9.62726 3.22276 8.95974 2.91116 8.26626C3.39211 8.38106 3.8578 8.55191 4.29861 8.77528L4.2936 8.80523ZM11.1784 3.55443C11.254 3.67672 11.3291 3.79817 11.4011 3.91962C12.1525 4.35877 13.0891 4.82787 13.6551 4.73305C14.0929 4.47917 14.4638 4.12507 14.737 3.70004C14.2361 3.46549 13.7352 3.16606 13.1492 2.81175C12.0873 2.18794 10.8251 1.44936 9.9085 1.25973C10.2201 1.95132 10.5834 2.61859 10.9954 3.25589C11.0559 3.35625 11.1173 3.45562 11.1784 3.55443Z" fill="white"/>
            </mask>
            <g mask="url(#mask0)">
            <rect y="0.220703" width="16" height="16" fill="#A4B6C0"/>
            </g>
            </svg>

            <p v-if="meal">{{ meal.protein }}g Protein</p>
          </div>
        </div>
        <!-- btn and tags -->
        <div v-if="meal" class="grey-tag-box">
          <strong>Contains:</strong>
          {{ meal.contains }}
        </div>
        <span class="mobile-popup-btns">
          <button
            @click="close()"
            class="ms-button-wide ms-outlined-button meal-button txt-center"
          >CANCEL</button>
          <button class="ms-button-wide ms-filled-button meal-button">ADD</button>
        </span>
      </div>
    </div>
  </div>
</template>

<script>
import { getSideDishByIndex } from './../mealFunctions.js'

export default {
  data() {
    return {
      meal: null,
      domain: null,
    }
  },
  mounted() {
    if (window.location.hostname === 'localhost')
      this.domain =
        window.location.protocol + '//' + window.location.hostname + ':8888'
    else this.domain = window.location.host
  },
  created() {
    let self = this
    this.$nuxt.$on('dish-info-popup-set-dish', (id) => {
      // set the meal
      self.meal = getSideDishByIndex(this.$store, id)
    })
    $nuxt.$emit('nav-bar-toggle', false)
  },
  beforeDestroy() {
    $nuxt.$emit('nav-bar-toggle', true)
  },
  methods: {
    close() {
      $nuxt.$emit('dish-info-close')
    },
  },
}
</script>

<style scoped>
.product-img {
  max-height: 280px;
  width: 535px;
  object-fit: cover;
}

.meal-name {
  font-family: Nunito;
  font-style: normal;
  font-weight: 800;
  font-size: 32px;
  line-height: 38px;
  text-align: center;
  letter-spacing: -0.9856px;
  color: #3c3c3c;
}

.popup-wizard-content {
  max-width: 535px;
}

.meal-values {
  margin-top: 6px;
  width: max-content;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.value-pair {
  display: inline-block;
  vertical-align: middle;
}

.value-pair p {
  font-style: normal;
  font-weight: normal;
  font-size: 16px;
  line-height: 16px;
  letter-spacing: 0.192941px;
  color: #3c3c3c;
  margin-bottom: 0px;
  display: inline-block;
}

.value-pair svg {
  display: inline-block;
  transform: translateY(1px);
}

.value-spacer {
  display: inline-block;
  margin-left: 6px;
  margin-right: 6px;
  width: 2px;
  opacity: 0.1;
  background-color: #293f94;
  height: 18px;
  vertical-align: bottom;
}

.grey-tag-box {
  padding-top: 20px;
  padding-bottom: 20px;
  padding-left: 40px;
  padding-right: 40px;
  background-color: #f6f9fc;
  border-radius: 2px;
  margin-top: 28px;
}

.meal-button {
  width: 225px;
  margin-top: 24px;
  text-align: center;
}

@media only screen and (max-width: 1282px) {
  .meal-name {
    font-weight: 800;
    font-size: 24px;
    line-height: 32px;
  }
  .value-pair p {
    font-size: 12px;
    line-height: 16px;
  }
  .meal-values {
    width: auto;
  }
  .meal-button {
    width: 48%;
    padding-left: 0px;
    padding-right: 0px;
  }
  .meal-button:last-child {
    margin-left: 2%;
    font-size: 15px;
    line-height: 20px;
  }
  .popup-wizard-content {
    max-width: 100%;
    height: 100%;
  }
  .mobile-popup-btns {
    position: absolute;
    bottom: 16px;
    width: calc(100% - 44px);
  }
}
</style>
